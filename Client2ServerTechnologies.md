# Client to Server 

|
|Client  |Server  |
|--|--|
|Mobile, Desktop, WebApp | Exposing resources and functionality
|  |  |

Need for 

 - Transport Protocol
 - Exchange of metadata

**WCF (SOAP), REST, gRPC**

History ...
How we exchange metadata ....

## Perspectives

 - Developer Productivity
	 - who's consuming the API's ? 
	 - are they on the same technology stack / platform ?
	 - Agile vs. Waterfall development approach.
 - Platform / Technology Stack 
   - .NET
   - Java
   - Other
   - Browser / JavaScript
   - Mobile 
  - Code first vs. Metadata first 
  - Code generation at development time vs. 'magic' at runtime ?
 - Who's the client ?
   - Building an API for your own app ?
   - Building an API for 3th Party consumers ?
     - Custom
     - Generic
  - Connected or Request/Response ?
  - Sync vs Async ?
  - Server side starts conversation patterns ?  - 
  - payload human readable or not ?

*Do not always just use what Visual Studio supports out-of-the-box or implement further on the code generated by standard templates.*
      *2 examples of this in this  session.*

## WCF

 SOAP stack
 
 Adress - Binding - Contract principle
 
 XSD driven design of datacontracts
 
 .wsdl / XSD
 
 Visual Studio ... Add Service Reference ...
 
 Why not just share the Interface and use ClientBase<T>
 
https://docs.microsoft.com/en-us/dotnet/framework/wcf/feature-details/generating-a-wcf-client-from-service-metadata
 
(failed) attempt for client side orchestrated transaction management.

XML only payload

### WCF in .Net Core

[https://dotnetfoundation.org/blog/2019/06/07/welcoming-core-wcf-to-the-net-foundation](https://dotnetfoundation.org/blog/2019/06/07/welcoming-core-wcf-to-the-net-foundation)

[https://github.com/CoreWCF/CoreWCF](https://github.com/CoreWCF/CoreWCF)

[https://devblogs.microsoft.com/premier-developer/grpc-asp-net-core-as-a-migration-path-for-wcfs-in-net-core/](https://devblogs.microsoft.com/premier-developer/grpc-asp-net-core-as-a-migration-path-for-wcfs-in-net-core/)

 
## REST
HTTP was created as a a protocol to transport webpages.

[https://en.wikipedia.org/wiki/Roy_Fielding](https://en.wikipedia.org/wiki/Roy_Fielding)

XML or JSON Payloads.

Promise of caching.
Client Cookies ...

### Overhead of REST 

https://en.wikipedia.org/wiki/Representational_state_transfer
#### Status Codes (Chaos)
https://restfulapi.net/http-status-codes/
#### Request/Response Headers
https://www.ibm.com/support/knowledgecenter/en/SSQP76_8.7.1/com.ibm.odm.itoa.ref/topics/ref_rest_headers_codes.html

https://mmikowski.github.io/the_lie/ (opiniated !, but has some truth)

[https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/418)

 #### Developing experience ...
https://en.wikipedia.org/wiki/Boilerplate_code

### Exchanging metadata in REST ?

No support for Address-Binding-Contract principle.
No support for metadata.

Look at [https://data.stad.gent/explore/dataset/real-time-bezettingen-fietsenstallingen-gent/](https://data.stad.gent/explore/dataset/real-time-bezettingen-fietsenstallingen-gent/)

Manually ...

Using [http://json2csharp.com/](http://json2csharp.com/)

### Swagger in .NET Fw
[http://wmpratt.com/swagger-and-asp-net-web-api-part-1/](http://wmpratt.com/swagger-and-asp-net-web-api-part-1/)

Nice, metadata, OK ...but **still code first approach.**

### NSwagStudio

Generating code.

[https://github.com/RicoSuter/NSwag/wiki/NSwagStudio](https://github.com/RicoSuter/NSwag/wiki/NSwagStudio)

https://github.com/RicoSuter/NSwag/tree/master/src/NSwag.CodeGeneration.CSharp/Templates

## Open API Specification

Finaly **metadata first** !

https://en.wikipedia.org/wiki/OpenAPI_Specification
https://www.openapis.org/blog/2017/03/01/openapi-spec-3-implementers-draft-released

[https://github.com/OAI/OpenAPI-Specification/blob/master/examples/v3.0/petstore.yaml](https://github.com/OAI/OpenAPI-Specification/blob/master/examples/v3.0/petstore.yaml)

[https://editor.swagger.io/](https://editor.swagger.io/)

Support for :
 - documentation
 - api gateways / routing
 - seeing the dependencies on enterprise level

### Use Visual Studio Code

[https://code.visualstudio.com/download](https://code.visualstudio.com/download)

https://marketplace.visualstudio.com/items?itemName=42Crunch.vscode-openapi

https://marketplace.visualstudio.com/items?itemName=Arjun.swagger-viewer

## gRPC

https://grpc.io/

Lightweight, no overhead, no boilertemplate code, cross platform.

Pure **metadata first approach**

https://docs.microsoft.com/en-us/aspnet/core/tutorials/grpc/grpc-start?view=aspnetcore-3.1&tabs=visual-studio

Code is generated 'magically', for both
- client
- server

ProtoBuff Serialization (not human readable, fast)

No complete support for Browser clients.

## Refit

Back to REST/WebApi's ... Contract first (in code) approach comparable to WCF

https://github.com/reactiveui/refit

https://anthonygiretti.com/2019/08/31/building-a-typed-httpclient-with-refit-in-asp-net-core-3/

Favorite for Mobile Xamarin apps !

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTEyMjY4NjE3OTVdfQ==
-->